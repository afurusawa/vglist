extends ./layout.jade

block title
    title #{game.title}

block content
    .something(ng-controller='gameController')

        if !user
            - user = { _id : 0 }

        //if #{img}
        //    img(src='data:image/jpeg;base64,#{img}')
        .game(ng-init='init = { userId : "#{user._id}", gameId : "#{game._id}" }')
            span #{game.title}
            span #{game.platform}
            span #{game.series}
            span #{released}
            span #{game.developer}
            span #{game.publisher}
            span #{game.metadata.userRating}
            span #{game.metadata.criticRating}

        .rate(ng-if='"#{user._id}".localeCompare("0")')
            button(ng-click="rateGame()" ng-show='rateButton.visible') Rate
            input(type='text', ng-hide='rateButton.visible', ng-model='$parent.rating')

        .hours-played(ng-if='"#{user._id}".localeCompare("0")')
            input(type='text', ng-model='$parent.hoursPlayed', placeholder="hours played")

        .add-to-list-btn(ng-if='"#{user._id}".localeCompare("0")')
            button(ng-click='addToList("#{game._id}", "#{game.title}")', ng-disabled="gameState.added") {{gameState.text}}


        p gid: {{init.gameId}}, uid: {{init.userId}}
        p {{userData}}
        p {{rating}}